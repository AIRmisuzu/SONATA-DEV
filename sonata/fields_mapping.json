{
  "TCP": {
    "bmv2": {
      "in_payload": false,
      "fields": [
        { "sonata_name": "srcPort", "target_name": "tcp.sport", "size": 16 },
        { "sonata_name": "dstPort", "target_name": "tcp.dport", "size": 16 },
        { "sonata_name": "seqNo", "target_name": "tcp.seqNo", "size": 32 },
        { "sonata_name": "ackNo", "target_name": "tcp.ackNo", "size": 32 },
        { "sonata_name": "dataOffset", "target_name": "tcp.dataOffset", "size": 4 },
        { "sonata_name": "res", "target_name": "tcp.res", "size": 3 },
        { "sonata_name": "ecn", "target_name": "tcp.ecn", "size": 3 },
        { "sonata_name": "ctrl", "target_name": "tcp.ctrl", "size": 6 },
        { "sonata_name": "window", "target_name": "tcp.window", "size": 16 },
        { "sonata_name": "checksum", "target_name": "tcp.checksum", "size": 16 },
        { "sonata_name": "urgentPtr", "target_name": "tcp.urgentPtr", "size": 16 }
      ],
      "child_layers": {}
    },
    "scapy": {}
  },
  "IPV4": {
    "bmv2": {
      "in_payload": false,
      "fields": [
        { "sonata_name": "version", "target_name": "ipv4.version", "size": 4 },
        { "sonata_name": "ihl", "target_name": "ipv4.ihl", "size": 4 },
        { "sonata_name": "diffserv", "target_name": "ipv4.diffserv", "size": 8 },
        { "sonata_name": "totalLen", "target_name": "ipv4.totalLen", "size": 16 },
        { "sonata_name": "identification", "target_name": "ipv4.identification", "size": 4 },
        { "sonata_name": "flags", "target_name": "ipv4.flags", "size": 3 },
        { "sonata_name": "fragOffset", "target_name": "ipv4.fragOffset", "size": 13 },
        { "sonata_name": "ttl", "target_name": "ipv4.ttl", "size": 8 },
        { "sonata_name": "protocol", "target_name": "ipv4.protocol", "size": 8 },
        { "sonata_name": "hdrChecksum", "target_name": "ipv4.hdrChecksum", "size": 16 },
        { "sonata_name": "srcAddr", "target_name": "ipv4.srcIP", "size": 32 },
        { "sonata_name": "dstAddr", "target_name": "ipv4.dstIP", "size": 32 }
      ],
      "child_layers": {"6": "TCP", "17": "UDP"}
    },
    "scapy": {}
  },
  "UDP":{
    "bmv2": {
      "in_payload": false,
      "fields": [
        { "sonata_name": "srcPort", "target_name": "udp.sport", "size": 16 },
        { "sonata_name": "dstPort", "target_name": "udp.dport", "size": 16 },
        { "sonata_name": "length_", "target_name": "udp.len", "size": 16 },
        { "sonata_name": "checksum", "target_name": "udp.checksum", "size": 16 }
      ],
      "child_layers": {"0": "DNS"}
    }
  },
  "Ethernet": {
    "bmv2": {
     "in_payload": false,
     "fields": [
       { "sonata_name": "dstAddr", "target_name": "ethernet.dstMac", "size": 48 },
       { "sonata_name": "srcAddr", "target_name": "ethernet.srcMac", "size": 48 },
       { "sonata_name": "ethType", "target_name": "ethernet.ethType", "size": 16 }
     ],
      "child_layers": { "0x0800": "IPV4"}
    }
  },
  "DNS": {
    "scapy": {
      "in_payload": true,
      "fields": [
        { "sonata_name": "dns.id", "target_name": "id", "size": 4 },
        { "sonata_name": "dns.qr", "target_name": "qr", "size": 1 },
        { "sonata_name": "dns.opcode", "target_name": "opcode", "size": 4 },
        { "sonata_name": "dns.aa", "target_name": "aa", "size": 1 },
        { "sonata_name": "dns.tc", "target_name": "tc", "size": 1 },
        { "sonata_name": "dns.rd", "target_name": "rd", "size": 1 },
        { "sonata_name": "dns.ra", "target_name": "ra", "size": 1 },
        { "sonata_name": "dns.z", "target_name": "z", "size": 1 },
        { "sonata_name": "dns.ad", "target_name": "ad", "size": 1 },
        { "sonata_name": "dns.cd", "target_name": "cd", "size": 1 },
        { "sonata_name": "dns.rcode", "target_name": "rcode", "size": 4 },
        { "sonata_name": "dns.qdcount", "target_name": "qdcount", "size": 4 },
        { "sonata_name": "dns.ancount", "target_name": "ancount", "size": 4 },
        { "sonata_name": "dns.nscount", "target_name": "nscount", "size": 4 },
        { "sonata_name": "dns.arcount", "target_name": "arcount", "size": 4 },

        { "sonata_name": "dns.qd.rrname", "target_name": "qd.rrname", "size": 64 },
        { "sonata_name": "dns.qd.type", "target_name": "qd.type", "size": 4 },
        { "sonata_name": "dns.qd.rclass", "target_name": "qd.rclass", "size": 4 },
        { "sonata_name": "dns.qd.ttl", "target_name": "qd.ttl", "size": 32 },
        { "sonata_name": "dns.qd.rdlen", "target_name": "qd.rdlen", "size": 4 },
        { "sonata_name": "dns.qd.rdata", "target_name": "qd.rdata", "size": 4 },


        { "sonata_name": "dns.an.rrname", "target_name": "an.rrname", "size": 64 },
        { "sonata_name": "dns.an.type", "target_name": "an.type", "size": 4 },
        { "sonata_name": "dns.an.rclass", "target_name": "an.rclass", "size": 4 },
        { "sonata_name": "dns.an.ttl", "target_name": "an.ttl", "size": 32 },
        { "sonata_name": "dns.an.rdlen", "target_name": "an.rdlen", "size": 4 },
        { "sonata_name": "dns.an.rdata", "target_name": "an.rdata", "size": 4 },


        { "sonata_name": "dns.ns.rrname", "target_name": "ns.rrname", "size": 64 },
        { "sonata_name": "dns.ns.type", "target_name": "ns.type", "size": 4 },
        { "sonata_name": "dns.ns.rclass", "target_name": "ns.rclass", "size": 4 },
        { "sonata_name": "dns.ns.ttl", "target_name": "ns.ttl", "size": 32 },
        { "sonata_name": "dns.ns.rdlen", "target_name": "ns.rdlen", "size": 4 },
        { "sonata_name": "dns.ns.rdata", "target_name": "ns.rdata", "size": 4 },

        { "sonata_name": "dns.ar.rrname", "target_name": "ar.rrname", "size": 64 },
        { "sonata_name": "dns.ar.type", "target_name": "ar.type", "size": 4 },
        { "sonata_name": "dns.ar.rclass", "target_name": "ar.rclass", "size": 4 },
        { "sonata_name": "dns.ar.ttl", "target_name": "ar.ttl", "size": 32 },
        { "sonata_name": "dns.ar.rdlen", "target_name": "ar.rdlen", "size": 4 },
        { "sonata_name": "dns.ar.rdata", "target_name": "ar.rdata", "size": 4 }
      ],
      "child_layers": {}
    }
  }
}